CITADEL VALIDATION REPORT
Date: 2026-02-12 10:30:51
Server: http://localhost:3000
Results: 17 PASS / 0 FAIL / 1 WARN
============================================================

[PASS] CONNECT :: API server reachable at http://localhost:3000
[INFO] CONNECT :: Initial threat level: 1 ()
[INFO] BASELINE :: Using DEK: prod-dek-legacy (d2f28fb28abeb8165e12246c664cff4e)
[PASS] ENCRYPT :: Encryption succeeded -- ciphertext 2354 hex chars
[PASS] DECRYPT :: Decryption roundtrip correct
[INFO] MEASURED :: Threat score before bad decrypt: 0
[PASS] MEASURED :: Wrong-AAD decrypt correctly rejected
[PASS] MEASURED :: Threat score after bad decrypt: 3 (delta: +3)
[PASS] MEASURED :: DecryptionFailure event auto-emitted into threat engine
[INFO] MEASURED :: After 4 total bad decrypts: score 12 (total delta: +12)
[INFO] ESCALATE :: Threat score: 102, Level: 5 (CRITICAL)
[PASS] ESCALATE :: Reached CRITICAL (level 5)
[INFO] FLOORS :: Policy compression at current threat level:
[PASS] FLOORS ::   Default DEK Policy rotation: 90d to 18d (floor: 1d)
[PASS] FLOORS ::   Default DEK Policy grace: 7d to 0.7d (floor: 0.5d)
[PASS] FLOORS ::   Default DEK Policy max_life: 365d to 91.25d (floor: 30d)
[PASS] FLOORS ::   Default DEK Policy auto_rotate: forced ON
[PASS] FLOORS ::   Default KEK Policy rotation: 365d to 73d (floor: 1d)
[PASS] FLOORS ::   Default KEK Policy grace: 30d to 3d (floor: 0.5d)
[PASS] FLOORS ::   Default KEK Policy auto_rotate: forced ON
[PASS] ENFORCE :: Fresh key encrypts at current threat (compliant -- age under rotation limit)
[PASS] ENFORCE :: Non-existent key returns 400 (not 403) -- error types distinguished
[INFO] HYSTERESIS :: Before reset: score=102, level=5 ()
[INFO] HYSTERESIS :: After reset: score=102, level=5 ()
[PASS] HYSTERESIS :: Score still above CRITICAL threshold -- level correctly holds
[WARN] CHAIN :: Audit file not found in project tree
[INFO] CHAIN :: Expected: citadel-audit.jsonl (written by IntegrityChainSink)
[INFO] CHAIN :: Check: did you restart server with the new main.rs?
